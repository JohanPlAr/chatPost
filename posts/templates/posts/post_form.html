{% extends 'base.html' %}

{% block content%}
<form action="" enctype="multipart/form-data" method="post">
{% csrf_token %}
{{form.as_p}}

<input type="submit" value="Submit"/>
</form>

<button id="upload_widget" class="cloudinary-button">Upload image</button>

<script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>  

<script type="text/javascript">  
var myWidget = cloudinary.createUploadWidget({
  cloudName: 'ddurovnhl', 
  uploadPreset: 'chatPost'}, (error, result) => { 
    if (!error && result && result.event === "success") {
        alert(result.info.secure_url);
      console.log('Done! Here is the image info: ', result.info); 
    }
  }
)

document.getElementById("upload_widget").addEventListener("click", function(){
    myWidget.open();
  }, false);
</script>

{% endblock content %}